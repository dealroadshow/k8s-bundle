
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/finsight-logo-black.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Apps - Dealroadshow K8S Framework</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/atom-one-light.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Dealroadshow K8S Framework" class="md-header__button md-logo" aria-label="Dealroadshow K8S Framework" data-md-component="logo">
      
  <img src="../../assets/finsight-logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dealroadshow K8S Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apps
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Dealroadshow K8S Framework" class="md-nav__button md-logo" aria-label="Dealroadshow K8S Framework" data-md-component="logo">
      
  <img src="../../assets/finsight-logo-white.svg" alt="logo">

    </a>
    Dealroadshow K8S Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-read/" class="md-nav__link">
        How to read this docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../vision/" class="md-nav__link">
        Our vision
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Basic concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Basic concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manifests/" class="md-nav__link">
        Manifests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../containers/" class="md-nav__link">
        Containers
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Apps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Apps
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#names-and-aliases" class="md-nav__link">
    Names and aliases
  </a>
  
    <nav class="md-nav" aria-label="Names and aliases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-manifest-only-for-a-subset-of-apps" class="md-nav__link">
    Generating manifest only for a subset of apps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-app-alias-inside-manifest-classes" class="md-nav__link">
    Accessing app alias inside manifest classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-manifest-name-prefixes" class="md-nav__link">
    Configuring manifest name prefixes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apps-directory-structure" class="md-nav__link">
    App's directory structure
  </a>
  
    <nav class="md-nav" aria-label="App's directory structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-dir" class="md-nav__link">
    Container dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-dir" class="md-nav__link">
    Manifest dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resources-dir" class="md-nav__link">
    Resources dir
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary_1" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lifecycle/" class="md-nav__link">
        Application lifecycle
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../methods-interception/" class="md-nav__link">
        Manifest methods interception
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../env-management/" class="md-nav__link">
        Environments management
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../reusable-apps/" class="md-nav__link">
        Distribute your apps
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#names-and-aliases" class="md-nav__link">
    Names and aliases
  </a>
  
    <nav class="md-nav" aria-label="Names and aliases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-manifest-only-for-a-subset-of-apps" class="md-nav__link">
    Generating manifest only for a subset of apps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-app-alias-inside-manifest-classes" class="md-nav__link">
    Accessing app alias inside manifest classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-manifest-name-prefixes" class="md-nav__link">
    Configuring manifest name prefixes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apps-directory-structure" class="md-nav__link">
    App's directory structure
  </a>
  
    <nav class="md-nav" aria-label="App's directory structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-dir" class="md-nav__link">
    Container dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-dir" class="md-nav__link">
    Manifest dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resources-dir" class="md-nav__link">
    Resources dir
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary_1" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="apps">Apps</h1>
<p>App is one of the basic concepts in Dealroadshow K8S Framework. You've probably already heard of <strong>Helm Charts</strong>. <em>App</em> in K8S Framework means the same thing - it is a collection of related <a href="../manifests/">manifests</a> that will be dumped together. What are criteria of moving some set of Kubernetes resources to app? Well, this Kubernetes resources should be <em>related</em>, but what does <em>related</em> means in this context? Generally this should mean that a set of manifests must be deployed together. So you may define an app as a set of Kubernetes manifests for a single service in SOA architecture, or for a microservice in microservice architecture. If you have a big monolith platform - you are probably thinking on how to split it into smaller pieces, which can be deployed separately. The same criteria may apply to corresponding manifests. </p>
<p>Every app must implement <strong><code>AppInterface</code></strong>. Let's see what method this interface defines:</p>
<pre class="php"><code>interface AppInterface extends ConfigurableInterface
{
    public static function name(): string;

    /**
     * @return string The alias with which app was registered in AppRegistry
     */
    public function alias(): string;

    public function addManifestFile(string $fileNameWithoutExtension, APIResourceInterface $resource): void;
    public function metadataHelper(): MetadataHelperInterface;
    public function namesHelper(): NamesHelperInterface;
    public function manifestNamePrefix(): string;
    public function manifestConfig(string $shortName): array;

    /**
     * @return ManifestFile[]
     */
    public function manifestFiles(): iterable;
}
</code></pre>
<p>Below, by walking through some important methods of <strong><code>AppInterface</code></strong>, we will better understand app's role. We don't discuss methods <code>addManifestFile()</code>, <code>metadataHelper()</code>, <code>namesHelper()</code>, <code>manifestConfig()</code> and <code>manifestFiles()</code> here - these are internal methods and they are not needed for you to understand apps. Some of this methods are discussed in other articles.</p>
<h2 id="names-and-aliases">Names and aliases</h2>
<p>Method <code>AppInterface::name()</code> defines default name of an app. What "<em>default</em>" means here? As you can see, this method is static, so different instances of an app class cannot return different names. But when do you need more than one instance of the same app class? Well, suppose you have <code>RedisApp</code> that contains manifests for <a href="https://redis.io/">Redis</a> cluster:</p>
<pre class="php"><code>namespace K8S\Redis;

use Dealroadshow\K8S\Framework\App\AbstractApp;

class RedisApp extends AbstractApp
{
    public static function name(): string
    {
        return 'redis';
    }
}
</code></pre>
<p>If you need just one Redis cluster - you don't need to configure anything. But what if you need two or more Redis clusters? It is possible to use <code>RedisApp</code> class to generate as many app copies as you need. All you have to do is <a href="../../lifecycle/#collecting-app-instances">register</a> one <code>RedisApp</code> instance in <code>AppRegistry</code> for every cluster you want. So if you need Kubernetes manifests for two clusters - you need to register two <code>RedisApp</code> instances with different <em>aliases</em>. If you use <a href="https://github.com/dealroadshow/k8s-bundle">K8S Bundle</a> with Symfony application (recommended way of using <a href="https://github.com/dealroadshow/k8s-framework">K8S Framework</a>), framework will register them for you - just configure them in <code>config/packages/dealroadshow_k8s.yaml</code> file:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">dealroadshow_k8s.yaml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">dealroadshow_k8s</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">apps</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alias</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">first-redis</span><span class="w"></span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">App\K8S\Redis\RedisApp</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alias</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">second-redis</span><span class="w"></span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">App\K8S\Redis\RedisApp</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alias</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span><span class="w"></span>
<span class="w">      </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">App\K8S\Redis\RedisApp</span><span class="w"></span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># You need to explicitly disable app registration by it&#39;s name() method</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<div class="admonition attention">
<p class="admonition-title">Important</p>
<p>Please note lines 7-9 in config above: we register two apps, <code>first-redis</code> and <code>second-redis</code> with <code>RedisApp</code> class, but without lines 7-9 there will be third app <code>redis</code> - class <code>RedisApp</code> will be found by Symfony DI as any other app class and will be added by it's name <code>redis</code>. So in order to avoid "default" app registration - register it explicitly by name, returned from app's method <code>name()</code>, and add option <code>enabled: false</code>.</p>
</div>
<p>So <code>alias</code> is a dynamic app name, that allows to have many different instances of the same app class with different names. And since by <a href="../manifests/#manifest-names">manifests naming convention</a> all manifest names are prefixed with app alias - this ensures that there will be no two manifests with the same name when you generate two copies of an app. </p>
<p>Let's demonstrate this with example. Suppose you have class <code>ClusterStatefulSet</code> in your <code>RedisApp</code>:</p>
<pre class="php"><code>namespace K8S\Redis\Manifest;

// ...

class ClusterStatefulSet extends AbstractContainerStatefulSet
{
    public static function shortName(): string
    {
        return 'cluster';
    }

    // other methods
}
</code></pre>
<p>If you need just one Redis cluster and you did not configure any aliases in config file - Symfony will find your <code>RedisApp</code> class, and will create and register instance by alias, taken from <code>RedisApp::name()</code> method - thus when you dump manifests you'll have directory <code>redis</code> and manifest file<code>redis/cluster.stateful-set.yaml</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">redis/cluster.stateful-set.yaml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StatefulSet</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span><span class="w"></span>
<span class="w">    </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-cluster</span><span class="w"></span>
<span class="c1"># ...</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>As you see, StatefulSet will have name <code>redis-cluster</code>.</p>
<p>However, if you configure two aliases like shown above, after dumping manifests you'll have directories <code>first-redis</code> and <code>second-redis</code>, files <code>first-redis/cluster.stateful-set.yaml</code> and <code>second-redis/cluster.stateful-set.yaml</code> with corresponding names <code>first-redis-cluster</code> and <code>second-redis-cluster</code>.</p>
<h3 id="generating-manifest-only-for-a-subset-of-apps">Generating manifest only for a subset of apps</h3>
<p>Suppose we have configured few instances of our <code>RedisApp</code> like in example above. Then, suppose we have some manifest class that we want to be generated only for <code>second-redis</code> app, but not for <code>first-redis</code>. This is easily done by using <code>EnabledForApps</code> PHP <a href="https://www.php.net/manual/en/language.attributes.overview.php">attribute</a> that comes with K8S Framework:</p>
<pre class="php"><code>#[EnabledForApps('second-redis')]
class MyExclusiveDeployment extends AbstractContainerDeployment
{
    public static function shortName(): string
    {
        return 'exclusive';
    }

    // ...
}</code></pre>
<p>As a result, there will be generated file <code>second-redis/exclusive.deployment.yaml</code> but no <code>first-redis/exclusive.deployment.yaml</code>.</p>
<h3 id="accessing-app-alias-inside-manifest-classes">Accessing app alias inside manifest classes</h3>
<p>Sometimes you need app alias in a manifest class. As mentioned in <a href="../manifests/#using-app-object-inside-manifests">Manifests</a> article, you may access app instance in any manifest by inherited property <code>$app</code>. So when you need app alias, access it like <code>$this-&gt;app-&gt;alias()</code>:</p>
<pre class="php"><code>class ClusterStatefulSet extends AbstractContainerStatefulSet
{
    public function selector(SelectorConfigurator $selector): void
    {
        $selector
            -&gt;addLabel('app', $this-&gt;app-&gt;alias())
            -&gt;addLabel('component', static::shortName())
        ;
    }

    // other methods
}</code></pre>
<p>Every app instance will have it's alias injected by K8S framework, so feel free to use method <code>AppInterface::alias()</code> on any app object.</p>
<h3 id="summary">Summary</h3>
<p>So, to summarize information about app names and aliases: in most of cases you don't need to configure app with aliases - by default they will be registered by their name, and alias will be the same as name. Configure app class with different aliases if you need more than one copy of the app generated.</p>
<h2 id="configuring-manifest-name-prefixes">Configuring manifest name prefixes</h2>
<p>Method <code>AppInterface::manifestNamePrefix()</code> is implemented in <code>AbstractApp</code> class and makes <a href="../manifests/#manifest-names">default naming convention</a> work:</p>
<div class="highlight"><span class="filename">AbstractApp.php</span><pre><span></span><code><span class="x">public function manifestNamePrefix(): string</span>
<span class="x">{</span>
<span class="x">    return $this-&gt;alias;</span>
<span class="x">}</span>
</code></pre></div>
<p>This method result is then used in <code>DefaultNamesHelper</code> class, which generates names for Kubernetes resources during manifests generation. It means that if you don't want your resource names to be prefixed with app names - just return an empty string from this method in your app class. Please read <a href="../../howtos/change-naming-convention/">dedicated article</a> if you want to change naming convention entirely.</p>
<h2 id="apps-directory-structure">App's directory structure</h2>
<p>Console command <code>k8s:generate:app</code> that comes with K8S Bundle generates app class and certain directory structure, which is a <em>recommended</em> but not mandatory way to structure your apps. By default your generated app will look like follows:</p>
<p><img alt="" src="../../assets/images/app-dir.png" /></p>
<p>Let's take a closer look at this structure. Every app class is stored in a dedicated directory / namespace, for example <code>HelloApp</code> class will be stored in <code>K8S\Hello</code> namespace, <code>RedisApp</code> - in <code>K8S\Redis</code> namespace and so on.
At top level of app directory there is app class itself and few nested directories.</p>
<h3 id="container-dir"><code>Container</code> dir</h3>
<p>Store your <a href="../containers/">container</a> classes in this directory. Note that this does not applies to <code>Container</code>-prefixed manifest classes, like classes that inherit from <code>AbstractContainerDeployment</code>. Most of the time you don't have separate container classes, so this directory is often deleted from generated app skeleton.</p>
<h3 id="manifest-dir"><code>Manifest</code> dir</h3>
<p>This is a most important directory in your app, since you should create your manifest classes in it. You may want to have some nested directories here, like <code>Manifest\Deployments</code>, <code>Manifest\ConfigMaps</code> and so on - feel free to create directory structure you like - Symfony and K8S framework will find and register your manifest classes by interfaces they implement, not by some exact file location.</p>
<h3 id="resources-dir"><code>Resources</code> dir</h3>
<p>If your app class extends <code>AbstractApp</code>, it will have method <code>readFile()</code>. Suppose your app has a deployment for some web service, and you want to mount config for your Nginx webserver from some <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>. If you store nginx config in your ConfigMap class like string literal - it would be ugly. Instead you can store your nginx config as <code>Resources/nginx.conf</code> and then use method <code>AbstractApp::readFile()</code> to store it in your ConfigMap:</p>
<pre class="php"><code>class NginxConfigMap extends AbstractConfigMap
{
    public function data(StringMap $data): void
    {
        $data-&gt;add('config', $this-&gt;app-&gt;readFile('nginx.conf'));
    }

    public static function shortName(): string
    {
        return 'nginx';
    }
}</code></pre>
<p>You may even want to implement more complex logic in your app class, for example method <code>compileTemplate()</code>- like if you want your nginx config to be generated from <a href="https://twig.symfony.com/">Twig</a> template. In any of such scenarios, <code>Resources</code> dir is a place to store auxiliary files for your manifests.</p>
<h2 id="summary_1">Summary</h2>
<p>In this article we got to know concept of apps better. If you did not yet read about <a href="../containers/">containers</a> - you should probably get to that article. You may also be interested in general <a href="../../lifecycle/">lifecycle</a> of manifest generation application.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../containers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Containers" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Containers
            </div>
          </div>
        </a>
      
      
        
        <a href="../../lifecycle/" class="md-footer__link md-footer__link--next" aria-label="Next: Application lifecycle" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Application lifecycle
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
      
        <script src="../../assets/init.js"></script>
      
    
  </body>
</html>
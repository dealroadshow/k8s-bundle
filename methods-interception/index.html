
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/finsight-logo-black.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Manifest methods interception - Dealroadshow K8S Framework</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/atom-one-light.min.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#manifest-methods-interception" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Dealroadshow K8S Framework" class="md-header__button md-logo" aria-label="Dealroadshow K8S Framework" data-md-component="logo">
      
  <img src="../assets/finsight-logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dealroadshow K8S Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Manifest methods interception
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Dealroadshow K8S Framework" class="md-nav__button md-logo" aria-label="Dealroadshow K8S Framework" data-md-component="logo">
      
  <img src="../assets/finsight-logo-white.svg" alt="logo">

    </a>
    Dealroadshow K8S Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../how-to-read/" class="md-nav__link">
        How to read this docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vision/" class="md-nav__link">
        Our vision
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Basic concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Basic concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/manifests/" class="md-nav__link">
        Manifests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/containers/" class="md-nav__link">
        Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/apps/" class="md-nav__link">
        Apps
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../lifecycle/" class="md-nav__link">
        Application lifecycle
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Manifest methods interception
      </a>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../env-management/" class="md-nav__link">
        Environments management
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../reusable-apps/" class="md-nav__link">
        Distribute your apps
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="manifest-methods-interception">Manifest methods interception</h1>
<p>Sometimes defining Kubernetes manifests involves code repetition, and you have to do the same repetitive job again and again. For example - you almost always have to define metadata labels at the top level of deployment manifest (<code>metadata.labels</code>), in pod spec template (<code>spec.template.metadata.labels</code>), and then section <code>spec.selector.matchLabels</code> should contain same labels. Thus you need copy-paste same labels 3 times every time you write a manifest. It would be great if there was a way to automate such repetitive tasks, and <em>manifests methods interception</em> is a way to do that in K8S Framework.</p>
<p>Dealroadshow K8S Framework uses <a href="https://en.wikipedia.org/wiki/Proxy_pattern">Proxy</a> pattern to wrap every instance of your manifest classes into a proxy-object. Then, when manifests are <a href="../lifecycle/#processing-apps">processed</a>, all methods of your manifests classes are called on proxy objects. This proxy objects wrap every method of original manifest instance in order to dispatch events before and after calling original methods, thus allowing you to intercept <strong>any</strong> method call. <a href="https://github.com/dealroadshow/k8s-framework">K8S Framework</a> uses <a href="https://github.com/php-fig/event-dispatcher">PSR-14</a> <code>EventDispatcherInterface</code> in order to dispatch all events, and  <a href="https://github.com/dealroadshow/k8s-budle">K8S Bundle</a> uses <a href="https://github.com/symfony/event-dispatcher">Symfony Event Dispatcher</a> component that implements this interface. Before every manifest method call <code>ManifestMethodEvent</code> is dispatched. After manifest method was called, <code>ManifestMethodCalledEvent</code> is dispatched. Among other things, you then may replace method's return value in <a href="https://symfony.com/doc/current/components/event_dispatcher.html#using-event-subscribers">event subscriber</a>. </p>
<p>Let's demonstrate possibilities of methods interceptions by automating the definition of <code>selector.matchLabels</code> and <code>metadata.labels</code> sections in all manifests, so that you don't have to write those ever again. For that, we will define  <a href="https://symfony.com/doc/current/components/event_dispatcher.html#using-event-subscribers">event subscriber</a> class <code>SelectorLabelsSubscriber</code> in a standard Symfony project location <code>src/EventListener</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">src/EventListener/SelectorLabelSubscriber.php</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="x">class SelectorLabelsSubscriber implements EventSubscriberInterface</span>
<span class="x">{</span>
<span class="x">    public function onManifestMethod(ManifestMethodEvent $event): void</span>
<span class="x">    {</span>
<span class="x">        $methodName = $event-&gt;methodName();</span>
<span class="x">        $params = $event-&gt;methodParams();</span>
<span class="x">        $manifest = $event-&gt;manifest();</span>
<span class="x">        if (&#39;selector&#39; !== $methodName || !($manifest instanceof DeploymentInterface)) {</span>
<span class="x">            // It&#39;s either not `selector()` method call, or not deployment&#39;s method being called</span>
<span class="x">            return;</span>
<span class="x">        }</span>

<span class="x">        /** @var SelectorConfigurator $selector */</span>
<span class="x">        $selector = $params[&#39;selector&#39;];</span>

<span class="x">        /** @var AppInterface $app */</span>
<span class="x">        $app = PropertyAccessUtil::getPropertyValue($manifest, &#39;app&#39;);</span>

<span class="x">        $selector</span>
<span class="x">            -&gt;addLabel(&#39;app&#39;, $app-&gt;alias())</span>
<span class="x">            -&gt;addLabel(&#39;component&#39;, $manifest::shortName())</span>
<span class="x">        ;</span>
<span class="x">    }</span>

<span class="x">    public static function getSubscribedEvents(): array</span>
<span class="x">    {</span>
<span class="x">        return [</span>
<span class="x">            ManifestMethodEvent::NAME =&gt; &#39;onManifestMethod&#39;</span>
<span class="x">        ];</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>As we see, our class implements Symfony's native <code>EventSubscriberInterface</code>, so thanks to autoconfiguration, just defining this class and implementing method <code>getSubscribedEvents()</code> as above is enough for it to recieve event every time manifest's method is about to be called. All logic of interception resides in method <code>onManifestMethod()</code>, which recieves events, so let's analyze it:</p>
<ul>
<li><strong>lines 8-10</strong>: we are checking if method being called is called <code>selector</code>, and if that manifest, on which this method is about to be called, is an instance of <code>DeploymentInterface</code>. If one of this conditions is false, we do nothing. Thus we are limiting our event subscriber to calls of method <code>selector()</code> on deployments.</li>
<li><strong>line 14</strong>: event object contains all parameters, passed to method being called. Method <code>DeploymentInterface::selector()</code> must recieve <code>SelectorConfigurator</code> instance as <code>$selector</code> argument, so we getting it from array of method params.</li>
<li><strong>line 17</strong>: there is no method that returns <a href="../concepts/apps/">app</a> in <code>ManifestInterface</code>, but any manifest that inherits K8S Framework's corresponding abstract classes (like <code>AbstractDeployment</code> for deployments) inherits property <code>$app</code> that contains app instance. Since this property is <a href="https://www.php.net/manual/en/language.oop5.visibility.php">protected</a>, we use <code>Dealroadshow\Bundle\K8SBundle\Util\PropertyAccessUtil</code> class to retrieve it from manifest instance.</li>
<li><strong>lines 19-22</strong>: we are using <code>$selector</code> argument of <code>DeploymentInterface::selector()</code> method to define two labels: <code>app</code>, that contains our <a href="../concepts/apps/#names-and-aliases">app alias</a>, and <code>component</code>, which contains short name of the deployment. </li>
</ul>
<p>Thus any generated deployment will have selector labels automatically. K8S Framework copies all labels from <code>selector.matchLabels</code> to <code>metadata.labels</code> and <code>spec.template.metadata.labels</code> sections automatically - so you'll never have to write this labels again in your deployments - all thanks to one event subscriber.</p>
<p>K8S Bundle also has predefined abstract classes that you may inherit from if you want to intercept manifest's methods: <code>AbstractMethodSubscriber</code> and <code>AbstractMethodResultSubscriber</code> - for intercepting method before it was called, or after, respectively.  Below is a new version of our <code>SelectorLabelsSubscriber</code> that inherits <code>AbstractMethodSubscriber</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">src/EventListener/SelectorLabelSubscriber.php</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="x">class SelectorLabelsSubscriber extends AbstractMethodSubscriber</span>
<span class="x">{</span>
<span class="x">    protected function supports(ManifestMethodEvent $event): bool</span>
<span class="x">    {</span>
<span class="x">        return &#39;selector&#39; === $event-&gt;methodName() &amp;&amp; $event-&gt;manifest() instanceof DeploymentInterface;</span>
<span class="x">    }</span>

<span class="x">    protected function beforeMethod(ManifestMethodEvent $event): void</span>
<span class="x">    {</span>
<span class="x">        /** @var SelectorConfigurator $selector */</span>
<span class="x">        $selector = $event-&gt;methodParams()[&#39;selector&#39;];</span>

<span class="x">        $manifest = $event-&gt;manifest();</span>
<span class="x">        /** @var AppInterface $app */</span>
<span class="x">        $app = PropertyAccessUtil::getPropertyValue($manifest, &#39;app&#39;);</span>

<span class="x">        $selector</span>
<span class="x">            -&gt;addLabel(&#39;app&#39;, $app-&gt;alias())</span>
<span class="x">            -&gt;addLabel(&#39;component&#39;, $manifest::shortName())</span>
<span class="x">        ;</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>This class is pretty self-explanatory now: method <code>supports()</code> is used to determine whether this subscriber should be called for the given event. Method <code>beforeMethod()</code> (for method result subscribers - <code>afterMethod()</code>) then does the real job, if <code>supports()</code> returned true.</p>
<p>Now that we have our subscriber, let's test it. First, let's define a simplest possible deployment class <code>ExampleDeployment</code> in <code>ExampleApp</code>:</p>
<div class="highlight"><span class="filename">src/Example/Manifest/ExampleDeployment.php</span><pre><span></span><code><span class="x">class ExampleDeployment extends AbstractContainerDeployment</span>
<span class="x">{</span>
<span class="x">    public function image(): Image</span>
<span class="x">    {</span>
<span class="x">        return Image::fromName(&#39;my-cool/image&#39;);</span>
<span class="x">    }</span>

<span class="x">    public static function shortName(): string</span>
<span class="x">    {</span>
<span class="x">        return &#39;example&#39;;</span>
<span class="x">    }</span>
<span class="x">}</span>
</code></pre></div>
<p>Now we can call console command to dump manifests into YAML files:</p>
<div class="highlight"><pre><span></span><code>bin/console k8s:dump:all
</code></pre></div>
<p>After command finished, let's look what YAML was generated from our <code>ExampleDeployment</code> class:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">example/example.deployment.yaml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">    </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-example</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">      </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">annotations</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">dealroadshow.com/env-sources-checksum</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d41d8cd98f00b204e9800998ecf8427e</span><span class="w"></span>
<span class="w">        </span><span class="nt">dealroadshow.com/volume-sources-checksum</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d41d8cd98f00b204e9800998ecf8427e</span><span class="w"></span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">        </span><span class="nt">component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span><span class="w"></span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"></span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-cool/image</span><span class="w"></span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class="w"></span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>Notice <strong>lines 4-6</strong>, <strong>11-13</strong> and <strong>19-21</strong>: we have our labels everywhere we need them. Isn't this cool?</p>
<p>Now that you know about manifests methods interception, you may use this technique to automate many things in your manifests. Please note that method interception also works for container methods: for example, if your deployment class inherits <code>AbstractContainerDeployment</code>, you may intercept it's method <code>resources()</code> or any other method from <code>ContainerInterrface</code>.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../lifecycle/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Application lifecycle" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Application lifecycle
            </div>
          </div>
        </a>
      
      
        
        <a href="../env-management/" class="md-footer__link md-footer__link--next" aria-label="Next: Environments management" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Environments management
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
      
        <script src="../assets/init.js"></script>
      
    
  </body>
</html>